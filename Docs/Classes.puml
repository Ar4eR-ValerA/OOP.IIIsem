@startuml

hide empty members

package Backups {
    class BackupJob {
        + StorageMode StorageMode
        - IJobObject JobObject
        - RestorePoint[] RestorePoints
        
        + RestorePoint Archive(string name)
    }
    
    interface IJobObject {
        + FileInfo[] GetFiles()
    }
    

    class FilesJobObject {
        + FileInfo[] FileInfos
    }
    
    class RestorePoint {
        ~ FileInfo[] LocalFileInfos
        ~ IStorage[] Storages
        - string Name
    }
    
    interface IStorage {
        + FileInfo[] GetFileInfos()
    }
    
    interface IArchiveService {
        + IArchiver Archiver
        
        + ArchiveRestorePoint(RestorePoint restorePoint, string path)
    }
    
    class ZipArchiver {
        + void ArchiveSingleMode(FileInfo[] FileInfos, string path)
        + void ArchiveSplitMode(FileInfo[] FileInfos, string path)
    }
    
    interface IArchiver {
        + void ArchiveSingleMode(FileInfo[] FileInfos, string path)
        + void ArchiveSplitMode(FileInfo[] FileInfos, string path)
    }
    
    class LocalArchiveServiceSingleMode {
        + IArchiver Archiver
        
        + ArchiveRestorePoint(RestorePoint restorePoint, string path)
    }
    
    class LocalArchiveServiceSplitMode {
            + IArchiver Archiver
            
            + ArchiveRestorePoint(RestorePoint restorePoint, string path)
        }
    
    class FileStorage {
        + FileInfo FileInfo
    }
    
    class DirectoryStorage {
        + DirectoryInfo DirectoryInfo
    }
}

package Backups.Client {
    class ServerArchiveService {
        + IArchiver Archiver
        + IPAddress IpAddress
        + int Port
                
        + ArchiveRestorePoint(RestorePoint restorePoint, string path)
    }
    
    class FileServerStorage {
        + FileInfo FileInfo
        + IPAddress IpAddress
        + int Port
        
        + FileInfo[] GetFileInfos()
    }
    
    interface IServerStorage {
        + FileInfo[] GetFileInfos()
        + IPAddress IpAddress
        + int Port
    }
    
    class FileSender {
        + void SendFile(FileInfo localFileInfo, FileServerInfo fileServerStorage)
    }
}

package Backups.Server {
    class Receiver {
        + void ReceiveFile(IPAddress ipAddress, int port)
    }
}

BackupJob o-- RestorePoint
RestorePoint o-- IStorage
BackupJob o-- IJobObject
RestorePoint <--> IArchiveService
IJobObject ..> FilesJobObject
IStorage ..> FileStorage
IStorage ..> DirectoryStorage
IArchiver -o IArchiveService
IArchiver ..> ZipArchiver
Backups --> Backups.Client
Backups.Client --> Backups.Server

ServerArchiveService <-- IServerStorage
ServerArchiveService <-- FileSender
IServerStorage ..> FileServerStorage

IArchiveService ..> LocalArchiveServiceSingleMode
IArchiveService ..> LocalArchiveServiceSplitMode


@enduml